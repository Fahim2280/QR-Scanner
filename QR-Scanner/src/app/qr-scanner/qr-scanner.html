<div class="qr-scanner-container">
  <h2>QR Scanner</h2>

  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading">
    <p>Loading camera...</p>
  </div>

  <!-- Error message -->
  <div *ngIf="errorMessage" class="error">
    <p>{{ errorMessage }}</p>
  </div>

  <!-- ZXing Scanner Component -->
  <div class="scanner-area">
    <zxing-scanner
      [formats]="formats"
      [device]="currentDevice"
      (scanSuccess)="onScanSuccess($event)"
      (camerasFound)="onCamerasFound($event)"
      (cameraError)="onCameraError($event)"
      [autostart]="true"
      class="scanner-element"
    >
    </zxing-scanner>

    <!-- Scanner overlay -->
    <div class="scanner-overlay">
      <div class="scan-line"></div>
    </div>
  </div>

  <!-- Camera selection -->
  <div *ngIf="availableDevices.length > 1" class="camera-selection">
    <label for="camera-select">Select Camera:</label>
    <select id="camera-select" (change)="onDeviceSelected($event)">
      <option
        *ngFor="let device of availableDevices; let i = index"
        [value]="i"
        [selected]="device === currentDevice"
      >
        {{ device.label || 'Camera ' + (i + 1) }}
      </option>
    </select>
  </div>

  <!-- Controls -->
  <div class="controls">
    <button *ngIf="qrResult" (click)="resetScanner()" class="btn btn-reset">Scan Again</button>
  </div>

  <!-- Result display -->
  <div *ngIf="qrResult" class="result">
    <h3>Scanned Result:</h3>
    <p class="result-data">{{ qrResult }}</p>

    <!-- Show action buttons based on result type -->
    <div class="result-actions">
      <button (click)="visitLink(qrResult)" class="btn btn-link" *ngIf="isValidUrl(qrResult)">
        Visit Link
      </button>
    </div>
  </div>
</div>
